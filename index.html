<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Auraflix</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* ESTILOS PARA ETIQUETAS DE NUEVO CONTENIDO (nuevo.js) */
        .new-content-badge {
            position: absolute;
            top: 5px;
            right: 5px; /* En una esquina superior */
            background-color: #8A2BE2; /* Fondo Morado */
            color: #e5e5e5; /* Letra Gris Claro */
            font-size: 0.65rem;
            font-weight: bold;
            padding: 3px 6px;
            border-radius: 4px;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            pointer-events: none; /* Para que no interfiera con el click */
        }
    </style>
</head>
<body>

    <input type="file" id="customAvatarInput" accept="image/*" style="display: none;">

    <div id="loginScreen" class="login-overlay">
        <div class="login-content">
            <h2>Bienvenido a Auraflix</h2>
            <p>Configura tu perfil para continuar</p>
            <div class="input-group">
                <input type="text" id="usernameInput" placeholder="Tu nombre" maxlength="15">
            </div>
            <p class="select-avatar-text">Elige tu avatar:</p>
            <div id="avatarGrid" class="avatar-grid"></div>
            <button id="saveProfileBtn" class="login-btn">Entrar <i class="fas fa-arrow-right"></i></button>
        </div>
    </div>

    <div id="changeAvatarModal" class="login-overlay">
        <div class="login-content">
            <h2 class="modal-title-gray">Cambiar Avatar</h2>
            <div id="changeAvatarGrid" class="avatar-grid"></div>
            <div class="modal-buttons-row">
                <button id="closeAvatarModal" class="cancel-btn">Cancelar</button>
                <button id="confirmAvatarChange" class="login-btn">Guardar</button>
            </div>
        </div>
    </div>

    <div id="vipModal" class="login-overlay">
        <div class="login-content vip-content-box">
            <h2 style="color: #8A2BE2; text-shadow: 0 0 10px #8A2BE2;">Zona VIP</h2>
            <p style="color: #ccc; margin-bottom: 20px;">Accede a contenido exclusivo sin interrupciones por 24 horas.</p>
            
            <div class="vip-actions-container">
                <button id="btnVipTutorial" class="vip-option-btn"><i class="fas fa-play-circle"></i> Tutorial</button>
                <button id="btnGetVipCode" class="vip-option-btn"><i class="fas fa-external-link-alt"></i> Conseguir Código</button>
            </div>

            <div class="vip-input-area">
                <p style="margin-bottom: 5px; color: #aaa; font-size: 0.9rem;">Escribir código:</p>
                <input type="text" id="vipCodeInput" placeholder="Ingresa tu código aquí" class="vip-input">
            </div>

            <div class="modal-buttons-row">
                <button id="closeVipModal" class="cancel-btn">Cerrar</button>
                <button id="activateVipBtn" class="login-btn vip-activate-style">Activar VIP</button>
            </div>
        </div>
    </div>

    <div id="tutorialModal" class="login-overlay">
        <div class="login-content" style="max-width: 600px; width: 95%;">
            <h3 style="color: white; margin-bottom: 15px;">Cómo conseguir el código</h3>
            <div id="tutorialVideoContainer" class="video-container">
            </div>
            <button id="closeTutorialBtn" class="login-btn" style="margin-top: 15px; width: 100%;">Entendido</button>
        </div>
    </div>

    <div id="filterModal" class="login-overlay">
        <div class="login-content filter-content-box">
            <div class="filter-header-row">
                <h2 class="modal-title-gray">Filtrar por Género</h2>
                <button id="closeFilterModal" class="close-icon-btn"><i class="fas fa-times"></i></button>
            </div>
            <div id="genresContainer" class="genres-grid"></div>
            <div class="modal-buttons-row" style="margin-top: 20px;">
                <button id="clearFiltersBtn" class="cancel-btn">Limpiar</button>
                <button id="applyFiltersBtn" class="login-btn">Aplicar Filtros</button>
            </div>
        </div>
    </div>

    <div id="requestModal" class="login-overlay">
        <div class="login-content">
            <h2 class="modal-title-gray">Solicitar Contenido</h2>
            <p style="color:#aaa; font-size:0.9rem; margin-bottom:20px;">¿No encuentras lo que buscas? Pídelo aquí.</p>
            
            <form action="https://formspree.io/f/xbdagwwa" method="POST" class="aura-form">
                <div class="form-group">
                    <label>Nombre de la Película / Serie:</label>
                    <input type="text" name="content_name" required placeholder="Ej: Interestelar" class="form-input">
                </div>
                <div class="form-group">
                    <label>Año (Opcional):</label>
                    <input type="number" name="content_year" placeholder="Ej: 2014" class="form-input">
                </div>
                <div class="form-group">
                    <label>Tu Email (Opcional):</label>
                    <input type="email" name="email" placeholder="Para avisarte..." class="form-input">
                </div>
                
                <div class="modal-buttons-row">
                    <button type="button" id="closeRequestModal" class="cancel-btn">Cancelar</button>
                    <button type="submit" class="login-btn">Enviar Solicitud</button>
                </div>
            </form>
        </div>
    </div>

    <div id="reportModal" class="login-overlay">
        <div class="login-content">
            <h2 class="modal-title-gray">Reportar Problema</h2>
            <p style="color:#ccc; font-size:0.9rem; margin-bottom:10px;">Estás reportando:</p>
            <h3 id="reportContentTitle" style="color:var(--main-color); margin-bottom:20px;">Título del Contenido</h3>

            <form action="https://formspree.io/f/xwvnlydl" method="POST" class="aura-form">
                <input type="hidden" name="content_reported" id="hiddenReportName">
                
                <div class="form-group">
                    <label>Detalles del error:</label>
                    <textarea name="message" required placeholder="Describe el problema (Ej: Enlace caído, sin audio, subtítulos mal...)" class="form-textarea"></textarea>
                </div>
                
                <div class="modal-buttons-row">
                    <button type="button" id="closeReportModal" class="cancel-btn">Cancelar</button>
                    <button type="submit" class="login-btn">Enviar Reporte</button>
                </div>
            </form>
        </div>
    </div>

    <div id="termsModal" class="login-overlay">
        <div class="login-content terms-content">
            <h2 class="modal-title-gray">Términos y Condiciones</h2>
            <div class="terms-text-container">
                <p><strong>TÉRMINOS Y CONDICIONES DE USO</strong></p>
                <p>Al acceder y utilizar esté servicio de películas y series aceptas cumplir con los presentes Términos y Condiciones. Si no estás de acuerdo con alguno de ellos, debes abstenerte de usar la App.</p>
                <h3>1. DESCRIPCIÓN DEL SERVICIO</h3>
                <p>La App proporciona información, organización y enlaces relacionados con películas y series con fines únicamente informativos y de entretenimiento. La App no aloja, reproduce ni distribuye directamente ningún contenido audiovisual en sus servidores.</p>
                <h3>2. CONTENIDO DE TERCEROS</h3>
                <p>Los enlaces, reproductores o contenidos mostrados en la App pueden pertenecer a terceros. La App no se responsabiliza por la disponibilidad, calidad, legalidad o veracidad del contenido ofrecido por sitios externos.</p>
                <h3>3. DERECHOS DE AUTOR</h3>
                <p>Todo el material audiovisual al que se hace referencia en la App pertenece a sus respectivos propietarios. La App no reclama derechos de autor sobre películas, series, logotipos o marcas mostradas.</p>
                <h3>4. USO ADECUADO</h3>
                <p>El usuario se compromete a utilizar la App de manera responsable y legal, y a no emplearla para actividades ilícitas, fraudulentas o que vulneren derechos de terceros.</p>
                <h3>5. LIMITACIÓN DE RESPONSABILIDAD</h3>
                <p>La App no será responsable por daños directos o indirectos derivados del uso o imposibilidad de uso del servicio, ni por problemas técnicos, fallos de conexión o contenido externo.</p>
                <h3>6. MODIFICACIONES</h3>
                <p>La App se reserva el derecho de modificar, actualizar o eliminar estos Términos y Condiciones en cualquier momento, sin previo aviso. El uso continuado de la App implica la aceptación de dichos cambios.</p>
                <h3>7. ENLACES EXTERNOS</h3>
                <p>La App puede contener enlaces a sitios web externos. No se tiene control sobre dichos sitios ni sobre sus políticas, por lo que la App no asume responsabilidad alguna por ellos.</p>
                <h3>8. SUSPENSIÓN DEL SERVICIO</h3>
                <p>La App puede suspender o finalizar el acceso al servicio en cualquier momento, ya sea por mantenimiento, actualizaciones o cualquier otra causa, sin obligación de previo aviso.</p>
                <h3>9. ACEPTACIÓN</h3>
                <p>Al usar la App, el usuario declara haber leído, entendido y aceptado estos Términos y Condiciones en su totalidad.</p>
            </div>
            <button id="closeTermsBtn" class="login-btn" style="margin-top:15px; width:100%;">Cerrar</button>
        </div>
    </div>

    <div id="supportModal" class="login-overlay">
        <div class="login-content">
            <h2 class="modal-title-gray">Soporte</h2>
            <p style="color:#aaa; font-size:0.9rem; margin-bottom:20px;">Escríbenos y te ayudaremos.</p>
            
            <form action="https://formspree.io/f/mzdaeqvg" method="POST" class="aura-form">
                <div class="form-group">
                    <label>Tu correo (Gmail):</label>
                    <input type="email" name="email" class="form-input" placeholder="ejemplo@gmail.com" required>
                </div>
                <div class="form-group">
                    <label>Tu mensaje:</label>
                    <textarea name="message" class="form-textarea" placeholder="Describe tu consulta..." required></textarea>
                </div>
                
                <button type="submit" class="login-btn" style="width: 100%;">Enviar</button>
            </form>
            
            <button id="closeSupportBtn" class="cancel-btn" style="margin-top: 15px; width: 100%;">Cerrar</button>
        </div>
    </div>

    <div id="updateModal" class="login-overlay">
        <div class="login-content">
            <h2 class="modal-title-gray">Actualización</h2>
            <div style="text-align: center; margin: 20px 0;">
                <i class="fas fa-mobile-alt" style="font-size: 3rem; color: #8A2BE2; margin-bottom: 15px;"></i>
                <p style="color: #ccc; font-size: 0.95rem; line-height: 1.5;">
                    Esta opción es solo necesaria para los usuarios que usan la <strong>Aplicación Android</strong>.<br><br>
                    Si estás usando la versión Web, no necesitas hacer nada.
                </p>
            </div>
            <button id="btnInstallUpdate" class="login-btn" style="width: 100%; margin-bottom: 10px;">
                <i class="fas fa-download"></i> Instalar Actualización
            </button>
            <button id="closeUpdateModal" class="cancel-btn" style="width: 100%;">Cerrar</button>
        </div>
    </div>

    <div id="settingsModal" class="login-overlay">
        <div class="login-content">
            <h2 class="modal-title-gray">Configuración</h2>
            
            <div class="settings-group">
                <div class="setting-item">
                    <span>Tamaño de Portadas</span>
                    <select id="gridSizeSelect" class="setting-select">
                        <option value="normal">Normal (3 Col)</option>
                        <option value="small">Pequeño (4 Col)</option>
                    </select>
                </div>
                
                <button id="btnCache" class="profile-action-btn" style="text-align: center; margin-top: 15px;">
                    <i class="fas fa-trash"></i> Borrar Caché
                </button>

                <div id="adminTools" style="display: none; border-top: 1px solid #333; margin-top: 20px; padding-top: 10px;">
                    <p style="color: #8A2BE2; font-size: 0.9rem; margin-bottom: 10px; font-weight: bold;">Herramientas Admin</p>
                    <button id="btnVerifyContent" class="profile-action-btn" style="text-align: center; margin-bottom: 10px; border: 1px solid #8A2BE2; color: #8A2BE2;">
                        <i class="fas fa-film"></i> Verificar Películas/Series
                    </button>
                    <button id="btnVerifyTrailers" class="profile-action-btn" style="text-align: center; border: 1px solid #FFbb33; color: #FFbb33;">
                        <i class="fas fa-video"></i> Verificar Tráilers
                    </button>
                </div>

                <p class="app-version">Versión 1.0.9</p>
            </div>

            <button id="closeSettingsBtn" class="cancel-btn">Cerrar</button>
        </div>
    </div>

    <div id="diagnosisModal" class="login-overlay">
        <div class="login-content" style="max-width: 500px; text-align: left;">
            <h3 id="diagnosisTitle" style="color:white; margin-bottom:10px;">Verificando...</h3>
            <p id="diagnosisStatus" style="color:#aaa; font-size:0.9rem; margin-bottom:10px;">Iniciando...</p>
            <div class="diagnosis-progress-track">
                <div id="diagnosisBar" class="diagnosis-progress-fill"></div>
            </div>
            <div id="diagnosisLog" class="diagnosis-log-container"></div>
            <button id="stopDiagnosisBtn" class="cancel-btn" style="width:100%;">Detener</button>
        </div>
    </div>

    <div id="shareModal" class="login-overlay">
        <div class="login-content">
            <h2 class="modal-title-gray">Compartir</h2>
            <div style="display: flex; flex-direction: column; gap: 15px; margin: 20px 0;">
                <button id="btnShareAppVersion" class="profile-action-btn" style="text-align: center;">
                    <i class="fas fa-mobile-alt"></i> Compartir App
                </button>
                <button id="btnShareWebVersion" class="profile-action-btn" style="text-align: center;">
                    <i class="fas fa-globe"></i> Compartir Web
                </button>
            </div>
            <button id="closeShareModal" class="cancel-btn">Cancelar</button>
        </div>
    </div>

    <div id="seasonSelectorModal" class="season-modal-overlay">
        <div class="season-modal-content">
            <h3 class="season-modal-title">Seleccionar temporada</h3>
            <div id="seasonListContainer" class="season-list-container"></div>
            <button id="closeSeasonSelector" class="cancel-btn" style="margin-top:15px; width:100%;">Cancelar</button>
        </div>
    </div>

    <header>
        <div class="header-left">
            <div class="logo">Auraflix</div>
        </div>
        <div class="header-right" id="headerRightIcons">
            <button id="topSearchBtn" class="header-icon-btn"><i class="fas fa-search"></i></button>
            <button id="topHistoryBtn" class="header-icon-btn"><i class="fas fa-clock"></i></button>
        </div>
    </header>

    <div id="mainContent">
        <div id="view-home">
            <section id="hero" class="hero">
                <div class="carousel-container"></div>
                <div class="hero-gradient"></div>
                <div id="heroDots" class="carousel-indicators"></div>
            </section>
            
            <h2 class="section-title">Últimamente nuevo</h2>
            <div id="latelyNewGrid" class="row grid-layout"></div>
            
            <h2 class="section-title">Recién agregadas</h2>
            <div id="newlyAddedRow" class="row horizontal-scroll"></div>
            <h2 class="section-title">Películas Destacadas</h2>
            <div id="homeMoviesRow" class="multi-row-container"></div>
            <h2 class="section-title">Series Destacadas</h2>
            <div id="homeSeriesRow" class="multi-row-container"></div>
        </div>

        <div id="view-movies" class="hidden full-page-view">
            <div class="section-header-flex">
                <h2 class="section-title-large no-margin">Películas</h2>
                <button id="btnFilterMovies" class="filter-toggle-btn"><i class="fas fa-sliders-h"></i> Filtrar</button>
            </div>
            <div id="activeFiltersMovies" class="active-filters-display"></div>
            <div id="allMoviesGrid" class="row grid-layout"></div>
        </div>

        <div id="view-series" class="hidden full-page-view">
            <div class="section-header-flex">
                <h2 class="section-title-large no-margin">Series</h2>
                <button id="btnFilterSeries" class="filter-toggle-btn"><i class="fas fa-sliders-h"></i> Filtrar</button>
            </div>
            <div id="activeFiltersSeries" class="active-filters-display"></div>
            <div id="allSeriesGrid" class="row grid-layout"></div>
        </div>

        <div id="view-profile" class="hidden full-page-view profile-view-container">
            <div class="profile-header">
                <div class="profile-img-wrapper">
                    <img id="profilePageImg" src="" alt="Avatar" class="profile-big-img">
                    <div class="edit-icon"><i class="fas fa-pen"></i></div>
                </div>
                <div class="profile-info">
                    <h2 id="profilePageName" class="profile-name">Usuario</h2>
                    <span id="profileBadge" class="profile-badge">Miembro</span>
                    
                    <div class="vip-profile-actions">
                        <button id="btnBecomeVip" class="vip-trigger-btn">Ser VIP <i class="fas fa-crown"></i></button>
                        <div id="vipTimerContainer" class="vip-timer hidden">
                            <i class="fas fa-hourglass-half"></i> <span id="vipTimerDisplay">--:--:--</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <h2 class="section-title">Mi Lista</h2>
            <div id="myListRow" class="row horizontal-scroll" style="min-height: 120px;"></div>
            
            <div class="profile-menu">
                <button id="btnRequestContent" class="profile-action-btn"><i class="fas fa-file-import" style="margin-right:10px; color:#8A2BE2;"></i> Solicitar Contenido</button>
                <button id="btnSupport" class="profile-action-btn">Soporte</button>
                <button id="btnBroadcast" class="profile-action-btn">Difusión</button>
                <button id="btnUpdateApp" class="profile-action-btn">Actualización</button>
                
                <button id="btnTerms" class="profile-action-btn">Términos y Condiciones</button>
                <button id="btnShare" class="profile-action-btn">Compartir</button>
                <button id="btnSettings" class="profile-action-btn">Configuración</button>
            </div>
            <button id="logoutBtn" class="logout-btn">Cerrar Sesión</button>
        </div>
    </div>

    <div id="videoModal" class="modal">
        <div class="modal-content">
            <button id="closeModal" class="close-modal"><i class="fas fa-arrow-left"></i></button>
            
            <div id="modalContentPlayer" class="player-wrapper">
            </div>

            <div class="modal-info">
                <h3 id="modalTitle" class="modal-title"></h3>
                <div class="modal-meta">
                    <span id="modalYear" class="modal-year"></span>
                    <span id="modalSeparator" class="modal-separator">|</span>
                    <span id="modalGenres" class="modal-genres"></span>
                </div>
                
                <div class="modal-actions-row">
                    <button id="modalActionBtn" class="hero-btn info"><i class="fas fa-film"></i> Ver Tráiler</button>
                    <button id="modalFavBtn" class="fav-btn"><i class="fas fa-heart"></i></button>
                    <button id="modalReportBtn" class="fav-btn report-btn-style"><i class="fas fa-exclamation-triangle"></i></button>
                </div>

                <p id="modalDesc" class="modal-desc"></p>
                
                <div id="seriesEpisodeSelector" class="hidden">
                    <div class="season-trigger-container">
                        <label>Temporada:</label>
                        <button id="btnOpenSeasonModal" class="season-trigger-btn">
                            <span id="currentSeasonText">Temporada 1</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div id="modalEpisodesContainer" class="episodes-list"></div>
                </div>
                
                <h3 class="modal-subtitle">Recomendados</h3>
                <div id="modalRecommendations" class="row grid-layout recommendations-grid"></div>
            </div>
        </div>
    </div>

    <div id="searchOverlay" class="search-overlay">
        <div class="overlay-header">
            <h2 class="overlay-title">Buscar</h2>
            <button id="closeSearch" class="close-overlay"><i class="fas fa-times"></i></button>
        </div>
        <div class="search-box">
            <input id="searchInput" type="text" placeholder="Buscar título...">
            <div class="popular-search-container">
                <p>Búsqueda popular</p>
                <div id="popularTags" class="popular-tags-flex"></div>
            </div>
        </div>
        <div id="searchResults" class="row grid-layout"></div>
    </div>

    <div id="historyOverlay" class="search-overlay">
        <div class="overlay-header">
            <h2 class="overlay-title">Continuar viendo</h2>
            <button id="closeHistory" class="close-overlay"><i class="fas fa-times"></i></button>
        </div>
        <div id="historyResults" class="row grid-layout" style="padding: 0 4%;"></div>
    </div>

    <nav class="bottom-nav">
        <a href="#" id="nav-home" class="nav-item active"><i class="fas fa-home"></i> Inicio</a>
        <a href="#" id="nav-movies" class="nav-item"><i class="fas fa-film"></i> Películas</a>
        <a href="#" id="nav-series" class="nav-item"><i class="fas fa-tv"></i> Series</a>
        <a href="#" id="nav-profile" class="nav-item">
            <div class="nav-profile-img-container">
                <img id="navProfileImg" src="" alt="P">
            </div>
            Perfil
        </a>
    </nav>

    <script>
        window.globalContent = [];
        const createTrackedArray = () => {
            const arr = [];
            const originalPush = arr.push;
            arr.push = function(...items) {
                items.forEach(item => { window.globalContent.push(item); });
                return originalPush.apply(this, items);
            };
            return arr;
        };
        window.moviesList = createTrackedArray();
        window.seriesList = createTrackedArray();
    </script>
    
    <script src="link.js"></script>
    <script src="cargador.js"></script>
    <script src="vip.js"></script>
    <script src="script.js"></script>
    <script src="nuevo.js"></script>
    <script>
        // Lógica simple para el botón de actualización en el HTML
        document.addEventListener('DOMContentLoaded', () => {
            const btnUpdate = document.getElementById('btnUpdateApp');
            const updateModal = document.getElementById('updateModal');
            const closeUpdate = document.getElementById('closeUpdateModal');
            const btnInstall = document.getElementById('btnInstallUpdate');

            if(btnUpdate) {
                btnUpdate.onclick = () => {
                    updateModal.style.display = 'flex';
                };
            }
            if(closeUpdate) {
                closeUpdate.onclick = () => {
                    updateModal.style.display = 'none';
                };
            }
            if(btnInstall) {
                btnInstall.onclick = () => {
                    if(typeof AURA_LINKS !== 'undefined' && AURA_LINKS.appDownload) {
                        window.open(AURA_LINKS.appDownload, '_blank');
                    } else {
                        alert("Enlace no disponible.");
                    }
                };
            }
        });
    </script>
</body>
</html>
